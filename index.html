<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Birthday Card Generator üéâ</title>
<style>
    body {
        margin: 0;
        font-family: 'Comic Sans MS', cursive, sans-serif;
        background: #ffe5f0;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 40px 20px;
    }

    /* Confetti dots background */
    body::before {
        content: '';
        position: fixed;
        width: 100%;
        height: 100%;
        background-image: radial-gradient(#ff6347 10%, transparent 10%),
                          radial-gradient(#ffde59 10%, transparent 10%),
                          radial-gradient(#6a5acd 10%, transparent 10%),
                          radial-gradient(#3cb371 10%, transparent 10%);
        background-size: 50px 50px;
        background-position: 0 0, 25px 25px, 10px 40px, 40px 10px;
        z-index: -1;
    }

    h1 {
        color: #ff6f61;
        text-align: center;
        margin-bottom: 30px;
    }

    .lang-switch {
        position: fixed;
        top: 15px;
        right: 20px;
        display: flex;
        gap: 10px;
    }

    .lang-switch button {
        padding: 6px 12px;
        border-radius: 6px;
        border: none;
        cursor: pointer;
        font-weight: bold;
        background: #ffd6d0;
    }

    .container {
        display: flex;
        justify-content: center;
        align-items: flex-start;
        gap: 50px;
        width: 100%;
        flex-wrap: wrap;
    }

    form {
        background: #fff3f0;
        padding: 25px;
        border-radius: 12px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        display: flex;
        flex-direction: column;
        gap: 15px;
        min-width: 280px;
    }

    input {
        padding: 13px;
        font-size: 1.3rem;
        border-radius: 5px;
        border: 1px solid #ccc;
    }

    button {
        padding: 13px;
        font-size: 1.2rem;
        border-radius: 5px;
        background: #ff6f61;
        color: white;
        border: none;
        cursor: pointer;
        font-weight: bold;
    }

    .secondary {
        background: #ffd6a5;
        color: #333;
    }

    .card {
        width: 680px;
        height: 380px;
        border-radius: 15px;
        background: #fffefc;
        box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        display: none;
        display: flex;
        overflow: hidden;
    }

    .card-left, .card-right {
        width: 50%;
        padding: 25px;
        box-sizing: border-box;
    }

    .card-left {
    background: #ffe6e6;
    border-right: 2px solid #ffb4a2;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 15px;
    font-style: italic;
    color: #ff6f61;
    font-size: 1.4rem;
    text-align: center;
    }


    .card-right {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
        gap: 15px;
    }

    .cake-icon {
        width: 104px;
        height: 104px;
    }

    #cardMessage {
        font-size: 1.6rem;
        line-height: 1.4;
        padding: 0 20px;
    }
</style>
</head>
<body>

<div class="lang-switch">
    <button onclick="setLang('ru')">RU</button>
    <button onclick="setLang('en')">EN</button>
</div>

<h1 id="title">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–º–µ—à–Ω—ã—Ö –æ—Ç–∫—Ä—ã—Ç–æ–∫ üéâ</h1>

<div class="container">
    <form id="birthdayForm">
        <input type="text" id="name">
        <input type="text" id="adjective">
        <input type="number" id="age">
        <input type="text" id="hobby">
        <button type="button" id="luckyButton" class="secondary"></button>
        <button type="submit" id="generateButton"></button>
    </form>

    <div class="card" id="card">
        <div class="card-left">
        <img src="./cake_img.png" class="cake-icon">
        <div id="cardLeftText"></div>
</div>
        <div class="card-right">
            <div id="cardMessage"></div>
            <button id="copyButton" class="secondary"></button>
        </div>
    </div>
</div>

<script>

alert("SCRIPT LOADED");
const BACKEND_URL = "https://birthday-llm-backend-production.up.railway.app";
const nameInput = document.getElementById("name");
const adjectiveInput = document.getElementById("adjective");
const ageInput = document.getElementById("age");
const hobbyInput = document.getElementById("hobby");

const translations = {
    ru: {
        title: "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–º–µ—à–Ω—ã—Ö –æ—Ç–∫—Ä—ã—Ç–æ–∫ üéâ",
        name: "–ò–º—è",
        adjective: "–ü—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω–æ–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä: –≤–µ–ª–∏–∫–æ–ª–µ–ø–Ω—ã–π)",
        age: "–í–æ–∑—Ä–∞—Å—Ç",
        hobby: "–•–æ–±–±–∏ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)",
        lucky: "üé≤ –ü–æ–≤–µ–∑—ë—Ç!",
        generate: "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å",
        copy: "–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å",
        leftCard: "–û—Å–æ–±–µ–Ω–Ω—ã–π –¥–µ–Ω—å –¥–ª—è –æ—Å–æ–±–µ–Ω–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞!",
        names: ["–î—Ä—É–∂–∏—â–µ", "–ß–µ–º–ø–∏–æ–Ω", "–ó–≤–µ–∑–¥–∞", "–õ–µ–≥–µ–Ω–¥–∞", "–ì–µ—Ä–æ–π"],
        adjectives: ["–ø–æ—Ç—Ä—è—Å–∞—é—â–∏–π", "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π", "–≤–µ–ª–∏–∫–æ–ª–µ–ø–Ω—ã–π", "–æ—Ñ–∏–≥–µ–Ω–Ω—ã–π", "—à–∏–∫–∞—Ä–Ω—ã–π"],
        hobbies: ["–µ—Å—Ç—å —Ç–æ—Ä—Ç", "—Ç–∞–Ω—Ü–µ–≤–∞—Ç—å", "–≤–µ—Å–µ–ª–∏—Ç—å—Å—è", "–ø—Ä–∞–∑–¥–Ω–æ–≤–∞—Ç—å", "–æ—Ç—Ä—ã–≤–∞—Ç—å—Å—è"],
        ages: [18, 21, 25, 30, 35, 40, 50, 99],
        messages: [
            "–° –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è, —Ç—ã {adj} {name}! –¢–µ–±–µ {age} –ª–µ—Ç ‚Äî —ç—Ç–æ –º–æ—â—å!",
            "{name}, —Ç—ã –ø—Ä–æ—Å—Ç–æ {adj}! {age} —Ç–µ–±–µ –æ—á–µ–Ω—å –∏–¥—ë—Ç!",
            "–° –∫–∞–∂–¥—ã–º –≥–æ–¥–æ–º —Ç—ã –≤—Å—ë –±–æ–ª–µ–µ {adj}! –ü–æ–∑–¥—Ä–∞–≤–ª—è—é —Å {age}-–ª–µ—Ç–∏–µ–º!",
            "–° –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è —Å–∞–º–æ–≥–æ {adj} —á–µ–ª–æ–≤–µ–∫–∞ –Ω–∞ –ø–ª–∞–Ω–µ—Ç–µ!",
            "{name}, —Ç–µ–±–µ {age}, –∏ —Ç—ã –≤—Å—ë –µ—â—ë –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ {adj}!"
        ],
        tail: "–ê —Ç–µ–ø–µ—Ä—å –∏–¥–∏ {hobby}! üéâ"
    },
    en: {
        title: "Funny Birthday Card Generator üéâ",
        name: "Name",
        adjective: "Adjective (optional)",
        age: "Age",
        hobby: "Hobby (optional)",
        lucky: "üé≤ Lucky me",
        generate: "Generate Card",
        copy: "Copy Message",
        leftCard: "A special day for someone amazing!",
        names: ["Buddy", "Champ", "Star", "Legend", "Hero"],
        adjectives: ["amazing", "legendary", "brilliant", "fantastic", "glorious"],
        hobbies: ["eat cake", "dance", "party", "celebrate", "have fun"],
        ages: [18, 21, 25, 30, 35, 40, 50, 99],
        messages: [
            "Happy Birthday, you {adj} {name}! {age} years of awesomeness!",
            "{name}, you are truly {adj}! {age} looks great on you!",
            "Another year older, another year more {adj}! Happy {age}!",
            "Happy Birthday to the most {adj} person ever!",
            "{name}, you're {age} and still incredibly {adj}!"
        ],
        tail: "Now go {hobby}! üéâ"
    }
};

let lang = "ru";

const form = document.getElementById('birthdayForm');
const card = document.getElementById('card');
const cardMessage = document.getElementById('cardMessage');
const copyButton = document.getElementById('copyButton');
const luckyButton = document.getElementById('luckyButton');

function pick(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
}

function setLang(l) {
    lang = l;
    const t = translations[l];

    document.getElementById("title").innerText = t.title;
    document.getElementById("name").placeholder = t.name;
    document.getElementById("adjective").placeholder = t.adjective;
    document.getElementById("age").placeholder = t.age;
    document.getElementById("hobby").placeholder = t.hobby;
    luckyButton.innerText = t.lucky;
    document.getElementById("generateButton").innerText = t.generate;
    copyButton.innerText = t.copy;
    document.getElementById("cardLeftText").innerText = t.leftCard;
}

setLang("ru");

luckyButton.addEventListener("click", () => {
    const t = translations[lang];
    nameInput.value = pick(t.names);
    adjectiveInput.value = pick(t.adjectives);
    ageInput.value = pick(t.ages);
    hobbyInput.value = pick(t.hobbies);
});

async function generateFromLLM(payload) {
    alert("CALLING LLM BACKEND");
    const response = await fetch(`${BACKEND_URL}/generate`, {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify(payload)
    });

    if (!response.ok) {
        throw new Error("LLM request failed");
    }

    const data = await response.json();
    return data.message;
}


form.addEventListener("submit", async e => {
    e.preventDefault();
    const t = translations[lang];

    const payload = {
        name: nameInput.value.trim() || pick(t.names),
        adjective: adjectiveInput.value.trim() || pick(t.adjectives),
        age: ageInput.value.trim() || pick(t.ages),
        hobby: hobbyInput.value.trim() || pick(t.hobbies),
        lang: lang
    };

    card.style.display = "flex";
    cardMessage.innerText = "üéÇ Generating birthday magic‚Ä¶";

    const text = await generateFromLLM(payload);
    cardMessage.innerText = text;
});


copyButton.addEventListener("click", () => {
    navigator.clipboard.writeText(cardMessage.innerText);
    copyButton.innerText = "‚úî";
    setTimeout(() => copyButton.innerText = translations[lang].copy, 1200);
});

async function generateFromLLM(data) {
  const response = await fetch(`${BACKEND_URL}/generate`, {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify(data)
  });

  if (!response.ok) {
    throw new Error("LLM request failed");
  }

  const result = await response.json();
  return result.text;
}

</script>

</body>
</html>